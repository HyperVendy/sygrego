<% title "Editing user" %>

<h1><%= yield(:title) %></h1>

<%= render partial: "form", locals: { 
                              url: admin_user_path(@user), 
                              method: :put } %>

<br/>

<h2>Roles</h2>

<table class="table table-dark">
    <% @roles.each do |role| %>
    <tr>
    	<td> 
	    	<%= role.name  %></span></br>
    	</td>

    	<td> 
            <% if @user.roles.include?(role) %>
	    	<%= link_to "Remove", purge_admin_user_role_path(user_id: @user, id: role),
	        	              class: danger_button_class,
    	        	          user: "button",
                              method: :delete %>
            <% else %>
	    	<%= link_to "Add", add_admin_user_role_path(user_id: @user, id: role),
	        	              class: primary_button_class,
    	        	          user: "button",
                              method: :patch %>
            <% end %>
    	</td>
    </tr>
    <% end %>
</table>

<br/>

<h2>Groups</h2>

<table class="table table-dark">
    <% current_user.groups.order(:short_name).each do |group| %>
    <tr>
    	<td> 
	    	<%= group.short_name  %></span></br>
    	</td>

    	<td> 
	    	<%= link_to "Remove", purge_admin_user_group_path(user_id: @user, id: group),
	        	              class: danger_button_class,
    	        	          user: "button",
                              method: :delete %>
    	</td>
    </tr>
    <% end %>
    <tr>
        <%= form_with(url: add_group_admin_user_groups_path(user_id: @user), method: :patch) do |f| %> 
            <td><%= f.collection_select :group_id, @groups, :id, :short_name %></td>
	        <td><%= f.submit "Add", class: primary_button_class %></td>
        <% end %>	
    </tr>

</table>

<br/>

<%= link_to "Back", admin_users_path,
                  class: primary_button_class,
                  user: "button" %>
<%= link_to "Details", admin_user_path(@user),
                  class: primary_button_class,
                  user: "button" %>
<%= link_to "Destroy", admin_user_path(@user),
                  method: :delete,
                  data: { confirm: "Are you sure?" },
                  class: danger_button_class,
                  user: "button" %>
